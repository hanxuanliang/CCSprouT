<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>列表和元组，到底用哪一个？ | Coding Core Sprout</title>
    <meta name="description" content="Coding Core Sprout：处于萌芽阶段的 Code Repository">
    
    
    <link rel="preload" href="/CCSprouT/assets/css/0.styles.b6092737.css" as="style"><link rel="preload" href="/CCSprouT/assets/js/app.3bfe9cae.js" as="script"><link rel="preload" href="/CCSprouT/assets/js/2.354977f3.js" as="script"><link rel="preload" href="/CCSprouT/assets/js/13.26612607.js" as="script"><link rel="prefetch" href="/CCSprouT/assets/js/10.45b843d1.js"><link rel="prefetch" href="/CCSprouT/assets/js/11.e4062db1.js"><link rel="prefetch" href="/CCSprouT/assets/js/12.9c627950.js"><link rel="prefetch" href="/CCSprouT/assets/js/14.ff4e4a20.js"><link rel="prefetch" href="/CCSprouT/assets/js/15.a0266fcd.js"><link rel="prefetch" href="/CCSprouT/assets/js/16.6a35fdc0.js"><link rel="prefetch" href="/CCSprouT/assets/js/17.3de5d84d.js"><link rel="prefetch" href="/CCSprouT/assets/js/18.76424749.js"><link rel="prefetch" href="/CCSprouT/assets/js/19.c9d3905d.js"><link rel="prefetch" href="/CCSprouT/assets/js/20.8a9fd492.js"><link rel="prefetch" href="/CCSprouT/assets/js/21.1177fac8.js"><link rel="prefetch" href="/CCSprouT/assets/js/22.af347df1.js"><link rel="prefetch" href="/CCSprouT/assets/js/23.27183461.js"><link rel="prefetch" href="/CCSprouT/assets/js/24.a168e5ee.js"><link rel="prefetch" href="/CCSprouT/assets/js/25.6d454097.js"><link rel="prefetch" href="/CCSprouT/assets/js/26.a00a3bea.js"><link rel="prefetch" href="/CCSprouT/assets/js/27.f936fe6d.js"><link rel="prefetch" href="/CCSprouT/assets/js/28.6c80d6f0.js"><link rel="prefetch" href="/CCSprouT/assets/js/29.02acd1c8.js"><link rel="prefetch" href="/CCSprouT/assets/js/3.dcf3ad81.js"><link rel="prefetch" href="/CCSprouT/assets/js/30.3ea69c5d.js"><link rel="prefetch" href="/CCSprouT/assets/js/31.9e9abe71.js"><link rel="prefetch" href="/CCSprouT/assets/js/32.ec575d40.js"><link rel="prefetch" href="/CCSprouT/assets/js/33.11753ff6.js"><link rel="prefetch" href="/CCSprouT/assets/js/34.6bd95441.js"><link rel="prefetch" href="/CCSprouT/assets/js/35.2ef9c3b5.js"><link rel="prefetch" href="/CCSprouT/assets/js/36.523dd0f6.js"><link rel="prefetch" href="/CCSprouT/assets/js/37.508cd470.js"><link rel="prefetch" href="/CCSprouT/assets/js/38.bdbf4774.js"><link rel="prefetch" href="/CCSprouT/assets/js/39.cc6e2686.js"><link rel="prefetch" href="/CCSprouT/assets/js/4.02903aa1.js"><link rel="prefetch" href="/CCSprouT/assets/js/40.e2be7e61.js"><link rel="prefetch" href="/CCSprouT/assets/js/5.662524a8.js"><link rel="prefetch" href="/CCSprouT/assets/js/6.415fb556.js"><link rel="prefetch" href="/CCSprouT/assets/js/7.82ad5c3b.js"><link rel="prefetch" href="/CCSprouT/assets/js/8.29dc5621.js"><link rel="prefetch" href="/CCSprouT/assets/js/9.ca5b5375.js">
    <link rel="stylesheet" href="/CCSprouT/assets/css/0.styles.b6092737.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/CCSprouT/" class="home-link router-link-active"><!----> <span class="site-name">Coding Core Sprout</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/CCSprouT/welcome/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">My-Blog</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/CCSprouT/blog/mysql/" class="nav-link">Mysql</a></li><li class="dropdown-item"><!----> <a href="/CCSprouT/blog/network/" class="nav-link">Network</a></li><li class="dropdown-item"><!----> <a href="/CCSprouT/blog/python/" class="nav-link router-link-active">AdvancePython</a></li><li class="dropdown-item"><!----> <a href="/CCSprouT/blog/tomcat/" class="nav-link">Tomcat容器</a></li></ul></div></div><div class="nav-item"><a href="/CCSprouT/ts-axios/" class="nav-link">TS-axios 重构文档</a></div><div class="nav-item"><a href="https://github.com/hanxuanliang/CCSprouT" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/CCSprouT/welcome/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">My-Blog</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/CCSprouT/blog/mysql/" class="nav-link">Mysql</a></li><li class="dropdown-item"><!----> <a href="/CCSprouT/blog/network/" class="nav-link">Network</a></li><li class="dropdown-item"><!----> <a href="/CCSprouT/blog/python/" class="nav-link router-link-active">AdvancePython</a></li><li class="dropdown-item"><!----> <a href="/CCSprouT/blog/tomcat/" class="nav-link">Tomcat容器</a></li></ul></div></div><div class="nav-item"><a href="/CCSprouT/ts-axios/" class="nav-link">TS-axios 重构文档</a></div><div class="nav-item"><a href="https://github.com/hanxuanliang/CCSprouT" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>AdvancePython</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/CCSprouT/blog/python/" class="sidebar-link">Python进阶</a></li><li><a href="/CCSprouT/blog/python/list-tuple.html" class="active sidebar-link">列表和元组，到底用哪一个？</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/CCSprouT/blog/python/list-tuple.html#基本回顾" class="sidebar-link">基本回顾</a></li><li class="sidebar-sub-header"><a href="/CCSprouT/blog/python/list-tuple.html#基本操作" class="sidebar-link">基本操作</a></li><li class="sidebar-sub-header"><a href="/CCSprouT/blog/python/list-tuple.html#存储差异" class="sidebar-link">存储差异</a></li><li class="sidebar-sub-header"><a href="/CCSprouT/blog/python/list-tuple.html#性能差异" class="sidebar-link">性能差异</a></li><li class="sidebar-sub-header"><a href="/CCSprouT/blog/python/list-tuple.html#使用场景" class="sidebar-link">使用场景</a></li><li class="sidebar-sub-header"><a href="/CCSprouT/blog/python/list-tuple.html#番外" class="sidebar-link">番外</a></li></ul></li><li><a href="/CCSprouT/blog/python/dict-set.html" class="sidebar-link">字典、集合，你真的了解吗？</a></li><li><a href="/CCSprouT/blog/python/string.html" class="sidebar-link">聊聊String</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="content default"><h1 id="列表和元组，到底用哪一个？"><a href="#列表和元组，到底用哪一个？" aria-hidden="true" class="header-anchor">#</a> 列表和元组，到底用哪一个？</h1> <h2 id="基本回顾"><a href="#基本回顾" aria-hidden="true" class="header-anchor">#</a> 基本回顾</h2> <p>列表和元组，都是<strong>一个可以放置任意数据类型的有序集合</strong>。</p> <div class="language-python extra-class"><pre class="language-python"><code>list1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token string">'world'</span><span class="token punctuation">]</span>
tup1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'json'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span>
list1<span class="token punctuation">,</span> tup1

<span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token string">'world'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'json'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>在绝大多数编程语言中，集合的数据类型必须一致。不过，对于Python的列表和元组来说，并无此要求</p> <p>其次，我们必须掌握它们的区别。</p> <ul><li><strong>列表是动态的</strong>，长度大小不固定，可以随意地增加、删减或者改变元素（mutable）。</li> <li><strong>而元组是静态的</strong>，长度大小固定，无法增加删减或者改变（immutable）。</li></ul> <div class="language-python extra-class"><pre class="language-python"><code>list1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">30</span>
list1

<span class="token operator">&gt;&gt;</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span>

tup1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">30</span>
tup1

<span class="token operator">&gt;&gt;</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
TypeError                                 Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span>
<span class="token operator">&lt;</span>ipython<span class="token operator">-</span><span class="token builtin">input</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">916d8e4e10e1</span><span class="token operator">&gt;</span> <span class="token keyword">in</span> <span class="token operator">&lt;</span>module<span class="token operator">&gt;</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">1</span> tup1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">30</span>
      <span class="token number">2</span> tup1

TypeError<span class="token punctuation">:</span> <span class="token string">'tuple'</span> <span class="token builtin">object</span> does <span class="token keyword">not</span> support item assignment

</code></pre></div><p>如果你想对已有的元组做任何&quot;改变&quot;，该怎么办呢？那就只能重新开辟一块内存，创建新的元组了。</p> <div class="language-python extra-class"><pre class="language-python"><code>new_tup1 <span class="token operator">=</span> tup1 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">)</span>
new_tup1

<span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span><span class="token string">'json'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>

<span class="token comment"># 原地改变</span>
list1<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
list1

<span class="token operator">&gt;&gt;</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span>
</code></pre></div><p>而对于列表来说，由于其是动态的，我们只需简单地在列表末尾，加入对应元素就可以了。如下操作后，会修改原来列表中的元素，而不会创建新的列表。</p> <h2 id="基本操作"><a href="#基本操作" aria-hidden="true" class="header-anchor">#</a> 基本操作</h2> <ul><li>支持<strong>负数索引</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code>l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
l<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token operator">&gt;&gt;</span> <span class="token number">4</span>

tup <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
tup<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token operator">&gt;&gt;</span> <span class="token number">4</span>
</code></pre></div><p>-1表示最后一个元素，-2表示倒数第二个元素，以此类推。</p> <ul><li><strong>切片操作</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># [a, b) ==&gt; 左闭右开</span>
<span class="token builtin">list</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
l<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>

<span class="token operator">&gt;&gt;</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>

tup <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
tup<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>

<span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> 
</code></pre></div><ul><li><strong>随意嵌套</strong>，<strong>相互转换</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code>l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># 列表的每一个元素也是一个列表</span>

tup <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 元组的每一个元素也是一元组</span>

<span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>

<span class="token builtin">tuple</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>内置函数</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code>count<span class="token punctuation">(</span>item<span class="token punctuation">)</span>：
<span class="token comment"># 统计列表/元组中item出现的次数。</span>

index<span class="token punctuation">(</span>item<span class="token punctuation">)</span>：
<span class="token comment"># 返回列表/元组中item第一次出现的索引。</span>

<span class="token builtin">list</span><span class="token punctuation">.</span>reverse<span class="token punctuation">(</span><span class="token punctuation">)</span>，<span class="token builtin">list</span><span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>：
<span class="token comment"># 分别表示原地倒转列表和排序（注意，元组无内置的这两个函数)。</span>

<span class="token builtin">reversed</span><span class="token punctuation">(</span><span class="token punctuation">)</span>，<span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：
<span class="token comment"># 表示对列表/元组进行倒转和排序，但是会返回一个新的列表/元组。</span>
</code></pre></div><h2 id="存储差异"><a href="#存储差异" aria-hidden="true" class="header-anchor">#</a> 存储差异</h2> <p>我们可以来看下面的例子：</p> <div class="language-python extra-class"><pre class="language-python"><code>l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
l<span class="token punctuation">.</span>__sizeof__<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token operator">&gt;&gt;</span> <span class="token number">64</span>

tup <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
tup<span class="token punctuation">.</span>__sizeof__<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token operator">&gt;&gt;</span> <span class="token number">48</span>
</code></pre></div><p>对列表和元组，我们放置了相同的元素，但是元组的存储空间，却比列表要少16字节。这是为什么呢？</p> <p>事实上，由于列表是动态的，所以它需要存储指针，来指向对应的元素（上述例子中，对于int型，8字节）。另外，由于列表可变，所以需要额外存储已经分配的长度大小（8字节），这样才可以实时追踪列表空间的使用情况，当空间不足时，及时分配额外空间。</p> <div class="language-python extra-class"><pre class="language-python"><code>l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
l<span class="token punctuation">.</span>__sizeof__<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 空列表的存储空间为40字节</span>
<span class="token operator">&gt;&gt;</span> <span class="token number">40</span>

l<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
l<span class="token punctuation">.</span>__sizeof__<span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token operator">&gt;&gt;</span> <span class="token number">72</span> 
<span class="token comment"># 加入了元素1之后，列表为其分配了可以存储4个元素的空间 (72 - 40)/8 = 4</span>

l<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> 
l<span class="token punctuation">.</span>__sizeof__<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span> <span class="token number">72</span> 
<span class="token comment"># 由于之前分配了空间，所以加入元素2，列表空间不变</span>

l<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
l<span class="token punctuation">.</span>__sizeof__<span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token operator">&gt;&gt;</span> <span class="token number">72</span> 
<span class="token comment"># 同上</span>

l<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
l<span class="token punctuation">.</span>__sizeof__<span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token operator">&gt;&gt;</span> <span class="token number">72</span> 

l<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
l<span class="token punctuation">.</span>__sizeof__<span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token operator">&gt;&gt;</span> <span class="token number">104</span> 
<span class="token comment"># 加入元素5之后，列表的空间不足，所以又额外分配了可以存储4个元素的空间</span>
</code></pre></div><p>我们可以看到，为了减小每次增加/删减操作时空间分配的开销，Python每次分配空间时都会额外多分配一些，这样的机制（over-allocating）保证了其操作的高效性：增加/删除的时间复杂度均为O(1)。</p> <p>**注意：**但是如果你是直接 <code>l = [1, 2, 3]</code> ，这种直接初始化列表，并没有增加元素的操作，因此只会分配3个元素的空间。</p> <p>但是对于元组，情况就不同了。元组长度大小固定，元素不可变，所以存储空间固定。</p> <h2 id="性能差异"><a href="#性能差异" aria-hidden="true" class="header-anchor">#</a> 性能差异</h2> <p>通过学习列表和元组存储方式的差异，我们可以得出结论：元组要比列表更加轻量级一些，所以总体上来说，元组的性能速度要略优于列表。</p> <p>另外，Python会在后台，对静态数据做一些<strong>资源缓存</strong>（resource caching）。通常来说，因为垃圾回收机制的存在，如果一些变量不被使用了，Python就会回收它们所占用的内存，返还给操作系统，以便其他变量或其他应用使用。</p> <p>但是对于一些静态变量，比如元组，如果它不被使用并且占用空间不大时，Python会暂时缓存这部分内存。这样，下次我们再创建同样大小的元组时，Python就可以不用再向操作系统发出请求，去寻找内存，而是可以直接分配之前缓存的内存空间，这样就能大大加快程序的运行速度。</p> <p>另外，我们看看两者的初始化一个相同元素的列表和元组分别所需的时间：</p> <div class="language-python extra-class"><pre class="language-python"><code>python3 <span class="token operator">-</span>m timeit <span class="token string">'x=(1,2,3,4,5,6)'</span>
<span class="token operator">&gt;&gt;</span> <span class="token number">20000000</span> loops<span class="token punctuation">,</span> best of <span class="token number">5</span><span class="token punctuation">:</span> <span class="token number">9.97</span> nsec per loop
    
python3 <span class="token operator">-</span>m timeit <span class="token string">'x=[1,2,3,4,5,6]'</span>
<span class="token operator">&gt;&gt;</span> <span class="token number">5000000</span> loops<span class="token punctuation">,</span> best of <span class="token number">5</span><span class="token punctuation">:</span> <span class="token number">50.1</span> nsec per loop
</code></pre></div><p>当然，如果你想要增加、删减或者改变元素，那么列表显然更优。原因你现在肯定知道了，那就是对于元组，你必须得通过新建一个元组来完成。</p> <h2 id="使用场景"><a href="#使用场景" aria-hidden="true" class="header-anchor">#</a> 使用场景</h2> <p><strong>1.</strong> 如果存储的数据和数量不变，比如你有一个函数，需要返回的是一个地点的经纬度，然后直接传给前端渲染，那么肯定选用元组更合适。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_location</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> 
    <span class="token keyword">return</span> <span class="token punctuation">(</span>longitude<span class="token punctuation">,</span> latitude<span class="token punctuation">)</span>
</code></pre></div><p><strong>2.</strong> 如果存储的数据或数量是可变的，比如社交平台上的一个日志功能，是统计一个用户在一周之内看了哪些用户的帖子，那么则用列表更合适。</p> <div class="language-python extra-class"><pre class="language-python"><code>viewer_owner_id_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># 里面的每个元素记录了这个viewer一周内看过的所有owner的id</span>

records <span class="token operator">=</span> queryDB<span class="token punctuation">(</span>viewer_id<span class="token punctuation">)</span> <span class="token comment"># 索引数据库，拿到某个viewer一周内的日志</span>

<span class="token keyword">for</span> record <span class="token keyword">in</span> records<span class="token punctuation">:</span>
    viewer_owner_id_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>record<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>3.</strong> 一般在<strong>key中使用元祖</strong>，其他情况多数都使用列表</p> <h2 id="番外"><a href="#番外" aria-hidden="true" class="header-anchor">#</a> 番外</h2> <p>这两个有区别吗？</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 创建空列表</span>
<span class="token comment"># option A</span>
empty_list <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># option B</span>
empty_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</code></pre></div><p><strong>Answer：</strong></p> <p>区别主要在于list()是一个<code>function call</code>，<code>Python的function call</code> 会创建 <code>stack</code>，并且进行一系列参数检查的操作，比较expensive，反观 <code>[]是一个内置的C函数</code>，可以直接被调用，因此效率高。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2019-5-24 22:02:29</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/CCSprouT/blog/python/" class="prev router-link-active">
          Python进阶
        </a></span> <span class="next"><a href="/CCSprouT/blog/python/dict-set.html">
          字典、集合，你真的了解吗？
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/CCSprouT/assets/js/app.3bfe9cae.js" defer></script><script src="/CCSprouT/assets/js/2.354977f3.js" defer></script><script src="/CCSprouT/assets/js/13.26612607.js" defer></script>
  </body>
</html>
